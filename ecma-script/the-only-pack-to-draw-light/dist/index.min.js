!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.theonlypacktodrawlight=e():t.theonlypacktodrawlight=e()}(window,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";r.r(e),r.d(e,"OPDrawLight",function(){return c});var n=r(1),o=r(5),i=r(6),u=r(7),c={cpu:{SDF:{Circle:n.Circle,Plane:o.Plane,Rect:i.Rect},render:u.render}}},function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function c(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?l(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}r.r(e),r.d(e,"Circle",function(){return b});var y=r(2),p=r(4),b=function(t){function e(t,r,n){var i;return o(this,e),i=c(this,a(e).call(this,t)),i._center=r,i._radius=n,i.getSourceDistance=i.getSourceDistance.bind(l(l(i))),i}return f(e,t),u(e,[{key:"getSourceDistance",value:function(t){var e=this._center,r=this._radius,n=Object(p.subf2)(t,e);return Math.sqrt(n.x*n.x+n.y*n.y)-r}}]),e}(y.SDF)},function(t,e,r){"use strict";function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){c(t,e,r[e])})}return t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.r(e),r.d(e,"SDF",function(){return f});var a=r(3),f=function(){function t(e){var r=this;o(this,t),c(this,"_opQueue",[]),c(this,"union",function(t){if(t)return r._opQueue.push({t:"u",to:t}),r}),c(this,"intersect",function(t){if(t)return r._opQueue.push({t:"i",to:t}),r}),c(this,"subtract",function(t){if(t)return r._opQueue.push({t:"s",to:t}),r}),this._props=n({},e),this.getLightSource=this.getLightSource.bind(this)}return u(t,[{key:"getSourceDistance",value:function(t){return 0}},{key:"getLightSource",value:function(t){var e=n({},this._props,{sourceDistance:this.getSourceDistance(t)}),r=new a.LightSource;for(var o in e)r[o]=e[o];return r}}]),t}()},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.r(e),r.d(e,"LightSource",function(){return i});var i=function t(e){var r=this;if(n(this,t),o(this,"sourceDistance",0),o(this,"emissive",0),o(this,"reflectivity",0),o(this,"eta",0),o(this,"triray",!1),o(this,"union",function(e){return new t(r.sourceDistance<e.sourceDistance?r:e)}),o(this,"intersect",function(e){var n=new t(r.sourceDistance>e.sourceDistance?e:r);return n.sourceDistance=r.sourceDistance>e.sourceDistance?r.sourceDistance:e.sourceDistance,n}),o(this,"subtract",function(e){var n=new t(r);return n.sourceDistance=r.sourceDistance>-e.sourceDistance?r.sourceDistance:-e.sourceDistance,n}),"string"==typeof e){switch(e){case"humble":break;case"awesome":this.reflectivity=.5;break;case"badass":this.reflectivity=.8,this.refract=1.5;break;case"asdfasdfasdfasdfasdf":default:this.reflectivity=.8,this.triray=!0}}else e&&(this.sourceDistance=e.sourceDistance,this.emissive=e.emissive,this.reflectivity=e.reflectivity,this.eta=e.eta,this.triray=e.triray)}},function(t,e,r){"use strict";function n(t,e){return{x:t.x+e.x,y:t.y+e.y}}function o(t,e){return{x:t.x*e,y:t.y*e}}function i(t,e){return n(t,o(e,-1))}function u(t,e){return o(t,1/e)}r.r(e),r.d(e,"addf2",function(){return n}),r.d(e,"mulf2",function(){return o}),r.d(e,"subf2",function(){return i}),r.d(e,"divf2",function(){return u})},function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function c(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?l(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}r.r(e),r.d(e,"Plane",function(){return p});var y=r(2),p=function(t){function e(t,r,n){var i;return o(this,e),i=c(this,a(e).call(this,t)),i._pxy=r,i._normal=n,i.getSourceDistance=i.getSourceDistance.bind(l(l(i))),i}return f(e,t),u(e,[{key:"getSourceDistance",value:function(t){var e=this._pxy,r=this._normal;return(t.x-e.x)*r.x+(t.y-e.y)*r.y}}]),e}(y.SDF)},function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function c(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?l(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}r.r(e),r.d(e,"Rect",function(){return p});var y=r(2),p=function(t){function e(t,r,n,i){var u;return o(this,e),u=c(this,a(e).call(this,t)),u._center=r,u._theta=n,u._s=i,u.getSourceDistance=u.getSourceDistance.bind(l(l(u))),u}return f(e,t),u(e,[{key:"getSourceDistance",value:function(t){var e=this._center,r=this._theta,n=this._s,o=Math.cos(r),i=Math.sin(r),u=Math.abs((t.x-e.x)*o+(t.y-e.y)*i)-n.x,c=Math.abs((t.y-e.y)*o-(t.x-e.x)*i)-n.y,a=Math.max(u,0),f=Math.max(c,0);return Math.min(Math.max(u,c),0)+Math.sqrt(a*a+f*f)}}]),e}(y.SDF)},function(t,e,r){"use strict";function n(t,e){var r=e._opQueue,o=e.getLightSource(t);if(0===r.length)return o;var i=!0,u=!1,c=void 0;try{for(var a,f=r[Symbol.iterator]();!(i=(a=f.next()).done);i=!0){var s=a.value,l=s.t,y=s.to;switch(l){case"u":o=o.union(n(t,y));break;case"i":o=o.intersect(n(t,y));break;case"s":o=o.subtract(n(t,y))}}}catch(t){u=!0,c=t}finally{try{i||null==f.return||f.return()}finally{if(u)throw c}}return o}function o(t,e){return n(t,e)}function i(t,e){return{x:(o({x:(t.x,t.y),y:0},e).sourceDistance-o({x:(t.x,t.y),y:0},e).sourceDistance)*(.5/h),y:(o({x:(t.x,t.y+h),y:0},e).sourceDistance-o({x:(t.x,t.y-h),y:0},e).sourceDistance)*(.5/h)}}function u(t,e){var r=2*(t.x*e.x+t.y*e.y);return{x:t.x-r*e.x,y:t.y-r*e.y}}function c(t,e,r){var n=t.x*e.x+t.y*e.y,o=1-r*r*(1-n*n),i=r*n+Math.sqrt(o);return{x:r*t.x-i*e.x,y:r*t.y-i*e.y}}function a(t,e,r,n){for(var f=0,s=o(t,r).sourceDistance>0?1:-1,y=0;y<p&&f<b;y++){var d=Object(l.addf2)(Object(l.mulf2)(e,f),t),m=o(d,r);if(m.sourceDistance*=s,m.sourceDistance<h){var g=m.emissive;if(n<3){var x=m.reflectivity;if(m.reflectivity>0||m.eta>0){var w=i(d,r);if(w=Object(l.mulf2)(w,s),m.eta>0){var O=c(e,w,s<0?m.eta:1/m.eta);g+=(1-x)*a(d-w*v,O,r,n+1)}if(x>0){var _=u(e,w);g+=x*a(d+w*v,_,r,n+1)}}}return g}f+=m.sourceDistance}return 0}function f(t,e){for(var r=0,n=0;n<y;n++){var o=2*Math.PI*(n+Math.random())/y;r+=a(t,{x:Math.cos(o),y:Math.sin(o)},e,0)}return r/64}function s(t,e){if(!t)throw new Error("canvas element not available.");var r=t.getContext("2d");if(!r)throw new Error("Canvas not supported on current browser.");for(var n=t.width,o=t.height,i=r.createImageData(n,o),u=0;u<o;u++)for(var c=0;c<n;c++){var a=u*n+c,s=Math.floor(255*f({x:1*c/n,y:1*u/o},e),0);i.data[4*a]=s,i.data[4*a+1]=s,i.data[4*a+2]=s,i.data[4*a+3]=255}r.putImageData(i,0,0)}r.r(e),r.d(e,"render",function(){return s});var l=r(4),y=32,p=10,b=4,h=1e-6,v=1e-4}])});